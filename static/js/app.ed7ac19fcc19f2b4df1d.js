webpackJsonp([2,0],[function(t,e,a){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e.default=t,e}function i(t){return t&&t.__esModule?t:{default:t}}var r=a(2),s=i(r),o=a(28),u=i(o),d=a(6),c=i(d),l=a(1),f=a(13),m=i(f),p=a(86),h=i(p),v=a(193),_=a(85),y=n(_),g=a(160),b=i(g);(0,v.sync)(m.default,h.default),(0,u.default)(y).forEach(function(t){c.default.filter(t,y[t])});var C=(0,s.default)({router:h.default,store:m.default},b.default);c.default.mixin({computed:(0,l.mapGetters)(["myId"]),methods:{itsMe:function(t){return!!this.myId&&!!t&&t==this.myId}}});var k=new c.default(C);k.$mount("#app")},,,,,,,,,,,function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={MAX_FEEDS:20,MAX_LIST:10,CACHE:{MAX_RECORDS:1e3},QINIU:{TOKEN:"8qmCfqkpvjGxHQnHUptAccm0cJsgqYHCO6nmLuZJ:CC9jYxxQF_BJvyo4LANViJ4D1Xs=:eyJzY29wZSI6InNoYXJlLWJvb2tzIiwiZGVhZGxpbmUiOjE0Nzk0NjQ0ODJ9"},AVATAR:{MAP:[{id:"",file:"empty.png",text:"请选择"},{id:"1",file:"av-0.jpg",text:"IT男"},{id:"2",file:"av-1.jpg",text:"经理男"},{id:"3",file:"av-2.jpg",text:"时髦女"}]}}},function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=a(84),r=n(i);e.default=new r.default},function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.msgBus=void 0;var i=a(6),r=n(i),s=a(1),o=n(s),u=a(194),d=(n(u),a(88)),c=n(d),l=a(89),f=n(l),m=a(87),p=n(m);r.default.use(o.default);var h=!1;e.msgBus=new r.default;e.default=new o.default.Store({modules:{message:c.default,self:f.default,cache:p.default},strict:h,plugins:[]})},,,,function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t){var e=t||{},a=[];for(var n in e)a.push(n);return a}function r(t){var e=t;e||(e={});var a=[];for(var n in e){var i=Number(n);NaN!=i&&a.push(i)}return a}Object.defineProperty(e,"__esModule",{value:!0}),e.loadDataFromIds=e.find=void 0,e.ObjPropKeys2Array=i,e.ObjIntPropKeys2Array=r;var s=a(6),o=n(s);e.find=function(t,e){return t=t||[],t.find(function(t){return t===e})},e.loadDataFromIds=function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"id";return t=t||[],e=e||[],e.map(function(e){var n=t.find(function(t){return t[a]===e});return o.default.util.extend({},n)})}},,,,,,,,,,function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.MSG_LOADING="LOADING",e.MSG_LOADED="LOADED",e.MSG_NOTIFY="NOTIFY",e.AUTH_LOGGEDIN="LOGGEDIN",e.AUTH_LOGOUT="LOGOUT",e.CHANGE_PROFILE="PROFILE",e.ADD_ITEM_TO_CACHE="ITEM2CACHE",e.ADD_USER_TO_CACHE="USER2CACHE",e.DEL_ITEM_FROM_CACHE="RM_ITEM",e.SYNC_KIDS="SYNC_KIDS",e.SYNC_OWNED="SYNC_OWNED",e.SYNC_LIKES="SYNC_LIKES",e.SET_ACTIVE_TYPE="ACTIVE_TYPE",e.SET_LIST="SET_LIST",e.SET_ITEMS="SET_ITEMS",e.SET_USER="SET_USER"},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,a){t.exports=a.p+"static/img/turnkey.d0421b3.png"},function(t,e,a){var n,i;n=a(68);var r=a(191);i=n=n||{},"object"!=typeof n.default&&"function"!=typeof n.default||(i=n=n.default),"function"==typeof i&&(i=i.options),i.render=r.render,i.staticRenderFns=r.staticRenderFns,t.exports=n},function(t,e,a){var n,i;n=a(72);var r=a(190);i=n=n||{},"object"!=typeof n.default&&"function"!=typeof n.default||(i=n=n.default),"function"==typeof i&&(i=i.options),i.render=r.render,i.staticRenderFns=r.staticRenderFns,t.exports=n},,,,,function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=a(1),r=a(161),s=n(r),o=a(166),u=n(o);e.default={name:"app",components:{AppMenu:s.default,Notify:u.default},computed:(0,i.mapGetters)(["authenticated","notifyType"])}},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a(1);e.default={methods:{myclass:function(t){var e="item";return(this.$route.path===t||this.$route.path.startsWith(t))&&(e="active "+e),e}},computed:(0,n.mapGetters)(["authenticated"])}},function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=a(2),r=n(i),s=a(17),o=a(1);e.default={props:["item"],data:function(){return{user:{},newComment:""}},created:function(){var t=this;this.loadUser(this.item.uid).then(function(e){t.user=e})},computed:(0,r.default)({},(0,o.mapGetters)(["authenticated","myId"]),{kids:function(){return(0,s.ObjIntPropKeys2Array)(this.item.kids)},likes:function(){return(0,s.ObjPropKeys2Array)(this.item.likes)},face:function(){var t=this.item.images||"empty.png",e=t.split(" "),a=Math.floor(Math.random()*e.length);return e[a]}}),methods:(0,r.default)({},(0,o.mapActions)(["addItem","loadUser","likeItem"]),{iLike:function(){console.log(this.myId,"like",this.item.title),this.likeItem({uid:this.myId,id:this.item.id})},addComment:function(){var t=this;console.log(this.newComment),this.addItem({uid:this.item.uid,title:this.newComment,parent:this.item.id}).then(function(){t.newComment="",$("#"+t.item.id).dimmer("show")})}})}},function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=a(2),r=n(i),s=a(1),o=a(11),u=n(o),d=a(12),c=n(d),l=a(60),f=n(l);e.default={name:"book-list",components:{BookCard:f.default},props:{type:String},data:function(){return{books:[],remote:[]}},created:function(){"top"==this.type?this.$bindAsArray("remote",c.default.api.child("top-books").orderByValue().limitToLast(u.default.MAX_LIST)):this.$bindAsArray("remote",c.default.api.child("new-books").orderByKey().limitToLast(u.default.MAX_LIST))},computed:{ids:function(){for(var t=[],e=this.remote||[],a=e.reverse(),n=0;n<a.length;n++)t.push(a[n][".key"]);return t}},watch:{remote:"loadBooks"},methods:(0,r.default)({},(0,s.mapActions)(["loadItems"]),{loadBooks:function(){var t=this;console.log("loaded Books",this.type),this.loadItems(this.ids).then(function(e){t.books=e})}})}},function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=a(2),r=n(i),s=a(1),o=a(17);e.default={name:"comment",props:["id","curItemId"],data:function(){return{open:!0,user:{},comment:{}}},created:function(){this.loadData()},computed:{keys:function(){var t=(0,o.ObjIntPropKeys2Array)(this.comment.kids);return t}},methods:(0,r.default)({},(0,s.mapActions)(["loadItem","loadUser"]),{emitReplyFor:function(t){this.$emit("ReplyFor",t)},loadData:function(){var t=this,e=this;this.loadItem(this.id).then(function(a){e.comment=a,t.loadUser(a.uid).then(function(t){e.user=t})})}})}},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a(1);e.default={replace:!0,name:"feed",data:function(){return{item:{},user:{}}},props:{record:Object},created:function(){var t=this;this.loadUser(this.record.uid).then(function(e){e||console.log("load user fail:",t.record.uid),t.user=e||{}}),this.loadItem(this.record.id).then(function(e){t.item=e})},methods:(0,n.mapActions)(["loadItem","loadUser"])}},function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=a(2),r=n(i),s=a(6),o=(n(s),a(1)),u=a(13);e.default={props:{type:String,itemId:Number},data:function(){return{header:"",title:"",keywords:"",images:"",text:""}},mounted:function(){this.load(),$(".myitem.modal").modal()},methods:(0,r.default)({},(0,o.mapActions)(["addItem","updateItem","loadItem"]),{load:function(){var t=this,e=0==this.itemId;if(this.header=e?"新增资料":"修改资料",!e){var a=this;this.loadItem(this.itemId).then(function(e){return e?(a.title=e.title,a.keywords=e.keywords,a.images=e.images,void(a.text=e.text)):void console.log("not found : ",t.itemId)})}},save:function(){var t=this;$(".myitem.modal").modal("hide"),0==this.itemId?this.addItem({title:this.title,parent:0,type:"",keywords:this.keywords,text:this.text,images:this.images}).then(function(t){u.msgBus.$emit("ItemAdded",t)}):!function(){var e={id:t.itemId,title:t.title,keywords:t.keywords,text:t.text,images:t.images};t.updateItem(e).then(function(){u.msgBus.$emit("ItemUpdated",e)})}()}})}},function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=a(28),r=n(i);e.default={replace:!0,props:{data:Array,columns:Array,filterKey:String,callback:Function},data:function(){var t={};return this.columns.forEach(function(e){t[e.key]=1}),{sortKey:"",sortOrders:t}},computed:{filteredData:function(){var t=this.sortKey,e=this.filterKey&&this.filterKey.toLowerCase(),a=this.sortOrders[t]||1,n=this.data;return e&&(n=n.filter(function(t){return(0,r.default)(t).some(function(a){return String(t[a]).toLowerCase().indexOf(e)>-1})})),t&&(n=n.slice().sort(function(e,n){return e=e[t],n=n[t],(e===n?0:e>n?1:-1)*a})),n}},methods:{sortBy:function(t){this.sortKey=t,this.sortOrders[t]=this.sortOrders[t]*-1}}}},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a(1);e.default={name:"notify",data:function(){return{txtQuery:""}},computed:(0,n.mapGetters)({loading:"loading",notify:"notifyMsg"}),methods:{search:function(){this.$router.push({name:"query",query:{keys:this.txtQuery}})}}}},function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=a(2),r=n(i),s=a(11),o=n(s),u=a(1);e.default={data:function(){return{displayName:"",email:"",photoURL:"",user:{},map:o.default.AVATAR.MAP}},computed:{booksURL:function(){return"/user/"+this.$route.params.uid+"/books"}},methods:(0,r.default)({},(0,u.mapActions)(["updateProfile","loadUser"]),{save:function(){this.updateProfile({user:{displayName:this.displayName,email:this.email,photoURL:this.photoURL}}).then(function(){$("useredit").dimmer("show")})}}),created:function(){var t=this;this.loadUser(this.$route.params.uid).then(function(e){t.user=e,e&&(t.displayName=e.displayName,t.email=e.email,t.photoURL=e.photoURL||"",$("#avatar").dropdown())})}}},function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=a(12),r=n(i),s=a(11),o=n(s),u=a(164),d=n(u);e.default={wilddog:{records:r.default.api.child("feed").orderByChild("time").limitToLast(o.default.MAX_FEEDS)},computed:{feeds:function(){return this.records.reverse()}},components:{Feed:d.default},methods:{login:function(){this.$router.push("/login")}}}},function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=a(2),r=n(i),s=a(1),o=a(13),u=a(17),d=a(163),c=n(d),l=a(61),f=n(l);e.default={name:"item-info",components:{Comment:c.default,ItemEdit:f.default},data:function(){return{item:{},newTitle:"",newText:"",curItemId:this.$route.params.id}},computed:(0,r.default)({},(0,s.mapGetters)(["authenticated"]),{keys:function(){var t=(0,u.ObjIntPropKeys2Array)(this.item.kids);return t},images:function(){var t=this.item.images||"empty.png",e=t.split(" ");return e}}),created:function(){this.loadData();var t=this;o.msgBus.$on("ItemUpdated",t.reload)},mounted:function(){$(".tabular.menu .item").tab(),$(".myitem.modal").modal("attach events","#editbook","show")},destroyed:function(){var t=this;o.msgBus.$off("ItemUpdated",t.reload)},methods:(0,r.default)({},(0,s.mapActions)(["loadItem","loadUser","addItem"]),{updateReplyId:function(t){this.curItemId=t},addComment:function(){this.addItem({title:this.newTitle,parent:this.curItemId,type:"",text:this.newText})},reload:function(t){console.log("ItemUpdated",t),this.loadData()},loadData:function(){console.log("ItemInfo loadData");var t=this,e=this.$route.params.id;return e?void this.loadItem(e).then(function(e){t.item=e}):void console.lod("itemId is null")}})}},function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=a(2),r=n(i),s=a(1);e.default={data:function(){return{mobile:"13612345678",pass:"123456"}},mounted:function(){$(".ui.form").form({on:"blur",fields:{mobile:{identifier:"mobile",rules:[{type:"regExp[/^[0-9]{11,11}$/]",prompt:"请输入11位手机号"}]},password:{identifier:"password",rules:[{type:"minLength[6]",prompt:"密码需要6位以上字母或数字"},{type:"maxLength[32]",prompt:"密码不得超过32位字母或数字"}]}}})},methods:(0,r.default)({mylogin:function(){var t=this,e=$(".form").form("validate form");if(e){var a=this;a.login({mobile:this.mobile,pass:this.pass}).then(function(e){var n={};return e?(n.type="info",n.notify="欢迎您："+e.displayName,a.notify(n),void(e&&t.$router.replace(t.$route.query.redirect||"/user/"+e.uid))):(n.type="error",n.notify="请检查手机号及密码是否正确！",void a.notify(n))})}}},(0,s.mapActions)(["beginLoad","afterLoad","login","notify"]))}},function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=a(2),r=n(i),s=a(1),o=a(12),u=n(o),d=a(60),c=n(d);e.default={components:{BookCard:c.default},data:function(){return{remote:[],books:[]}},created:function(){this.$bindAsArray("remote",u.default.api.child("new-books").orderByKey())},computed:{ids:function(){for(var t=[],e=this.remote.reverse(),a=0;a<e.length;a++)t.push(e[a][".key"]);return t}},watch:{ids:"loadBooks"},methods:(0,r.default)({},(0,s.mapActions)(["query"]),{loadBooks:function(){var t=this;console.log("query Books"),this.query({ids:this.ids,keys:this.$route.query.keys||""}).then(function(e){t.books=e})}})}},function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=a(2),r=n(i),s=a(1);e.default={data:function(){return{mobile:"13640327787",pass:"123456"}},mounted:function(){$(".ui.form").form({on:"blur",fields:{mobile:{identifier:"mobile",rules:[{type:"regExp[/^[0-9]{11,11}$/]",prompt:"请输入11位手机号"}]},password:{identifier:"password",rules:[{type:"minLength[6]",prompt:"密码需要6位以上字母或数字"},{type:"maxLength[32]",prompt:"密码不得超过32位字母或数字"}]}}})},methods:(0,r.default)({check:function(){var t=this,e=$(".form").form("validate form");if(e){var a=this,n={};a.beginLoad(),a.register({mobile:this.mobile,pass:this.pass}).then(function(e){a.afterLoad(),t.$router.replace("/login")}).catch(function(t){console.log(t),a.afterLoad(),n.type="error",n.notify="手机号错误或者改号已经被注册！",a.notify(n)})}}},(0,s.mapActions)(["beginLoad","afterLoad","register","notify"]))}},function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=a(167),r=n(i);e.default={name:"user-view",components:{UserEdit:r.default},mounted:function(){$(".ui.accordion").accordion()}}},function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=a(19),r=n(i),s=a(18),o=n(s),u=a(2),d=n(u),c=a(1),l=a(13),f=a(61),m=n(f),p=a(165),h=n(p);e.default={components:{ItemEdit:m.default,MyGrid:h.default},data:function(){return{searchQuery:"",gridColumns:[{key:"title",text:"书名"},{key:"keywords",text:"关键字"}],books:[]}},watch:{$route:"getBooks"},methods:(0,d.default)({},(0,c.mapActions)(["loadItemsByUser"]),{showBook:function(t){this.$router.push({name:"item",params:{id:t}})},reload:function(t){console.log("ItemAdded",t);var e=this;e.$route.params.uid==t.uid&&e.getBooks()},getBooks:function(){var t=this;return(0,o.default)(r.default.mark(function e(){var a;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.$route.params.uid,e.next=3,t.loadItemsByUser({uid:a,type:"book"});case 3:t.books=e.sent;case 4:case"end":return e.stop()}},e,t)}))()}}),destroyed:function(){var t=this;l.msgBus.$off("ItemAdded",t.reload)},created:function(){var t=this;this.getBooks(),l.msgBus.$on("ItemAdded",t.reload)},mounted:function(){$(".ui.accordion").accordion(),this.itsMe(this.$route.params.uid)&&$(".myitem.modal").modal("attach events","#addbook","show")}}},function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t){var e=t?l.prd:l.dev;return s.default.initializeApp(e),s.default.sync().ref()}Object.defineProperty(e,"__esModule",{value:!0});var r=a(62),s=n(r),o=a(6),u=n(o),d=a(197),c=n(d);u.default.use(c.default);var l={dev:{authDomain:"books.wilddog.com",syncURL:"https://books.wilddogio.com/test"},prd:{authDomain:"books.wilddog.com",syncURL:"https://books.wilddogio.com/v2"}};e.default=i},function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=a(19),r=n(i),s=a(18),o=n(s),u=a(92),d=n(u),c=a(93),l=n(c),f=a(83),m=n(f),p=a(62),h=n(p),v=function(){function t(){(0,d.default)(this,t),this.debug=!1,this.timestamp=!this.debug,this.api=(0,m.default)(!0)}return(0,l.default)(t,[{key:"login",value:function(t,e){return h.default.auth().signInWithPhoneAndPassword(t,e)}},{key:"loginByEmail",value:function(t,e){return h.default.auth().signInWithEmailAndPassword(t,e)}},{key:"curUser",value:function(){return h.default.auth().currentUser}},{key:"logout",value:function(){return h.default.auth().signOut()}},{key:"createUser",value:function(){function t(t,a){return e.apply(this,arguments)}var e=(0,o.default)(r.default.mark(function t(e,a){var n,i;return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.default.auth().createUserWithPhoneAndPassword(e,a);case 2:return n=h.default.auth().currentUser,i=""+n.uid,t.next=6,this.api.child("user/"+i).set({phone:e,uid:i});case 6:return console.log("createUser:",e),t.abrupt("return",n);case 8:case"end":return t.stop()}},t,this)}));return t}()},{key:"updateEmail",value:function(){function t(t){return e.apply(this,arguments)}var e=(0,o.default)(r.default.mark(function t(e){var a,n;return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=h.default.auth().currentUser,t.next=3,a.updateEmail(e);case 3:return n=""+a.uid,t.next=6,this.api.child("user/"+n).update({email:e});case 6:return t.abrupt("return",a);case 7:case"end":return t.stop()}},t,this)}));return t}()},{key:"updateProfile",value:function(){function t(t,a){return e.apply(this,arguments)}var e=(0,o.default)(r.default.mark(function t(e,a){var n,i,s;return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n={displayName:e,photoURL:a},i=h.default.auth().currentUser,s=""+i.uid,t.next=5,this.api.child("user/"+s).update(n);case 5:return t.next=7,i.updateProfile(n);case 7:return t.abrupt("return",i);case 8:case"end":return t.stop()}},t,this)}));return t}()},{key:"transaction",value:function(){function t(t,a){return e.apply(this,arguments)}var e=(0,o.default)(r.default.mark(function t(e,a){var n,i;return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.api.child(e).transaction(function(t){return(t||0)+a});case 2:if(n=t.sent,!n.committed){t.next=10;break}return i=Number(n.snapshot.val()),t.next=7,this.api.child(e).set(i);case 7:return t.abrupt("return",i);case 10:return console.log("transaction failed! ",e),t.abrupt("return",null);case 12:case"end":return t.stop()}},t,this)}));return t}()},{key:"push",value:function(t,e){return this.api.child(t).push(e)}},{key:"save",value:function(t,e){return this.api.child(t).set(e)}},{key:"update",value:function(t,e){return this.api.child(t).update(e)}},{key:"fetch",value:function(){function t(t){return e.apply(this,arguments)}var e=(0,o.default)(r.default.mark(function t(e){var a,n;return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.api.child(e).once("value");case 2:return a=t.sent,n=a.val(),n&&(this.timestamp&&n instanceof Object&&(n.__lastUpdated=Date.now()),this.debug&&console.log("load "+e+" from remote")),t.abrupt("return",n);case 6:case"end":return t.stop()}},t,this)}));return t}()}]),t}();e.default=v},function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t){t=t||"";var e="/static/images/empty.png";if(t.startsWith("http"))e=t;else{var a=l.default.AVATAR.MAP.find(function(e){return e.id==t});a&&(e="/static/images/"+a.file)}return e}function r(t){t=t||"";var e="/static/images/";return t.startsWith("http")?e=t:(""==t&&(t="empty.png"),e="/static/images/"+t),e}function s(t){var e=t.replace(/^https?:\/\//,"").replace(/\/.*$/,""),a=e.split(".").slice(-3);return"www"===a[0]&&a.shift(),a.join(".")}function o(t){t=t||0;var e=(Date.now()-Number(t))/1e3;return e<3600?u(~~(e/60),"分钟前"):e<86400?u(~~(e/3600),"小时前"):e<2592e3?u(~~(e/86400),"天前"):e<94608e4?u(~~(e/2592e3),"月前"):u(~~(e/94608e4),"年前")}function u(t,e){return t+e}function d(t,e,a){if(t=parseFloat(t),!isFinite(t)||!t&&0!==t)return"";e=null!=e?e:"元",a=null!=a?a:2;var n=Math.abs(t).toFixed(a),i=a?n.slice(0,-1-a):n,r=i.length%3,s=r>0?i.slice(0,r)+(i.length>3?",":""):"",o=a?n.slice(-1-a):"",u=t<0?"-":"";return u+e+s+i.slice(r).replace(f,"$1,")+o}Object.defineProperty(e,"__esModule",{value:!0}),e.tansformAvatarURL=i,e.tansformImageURL=r,e.host=s,e.timeAgo=o,e.currency=d;var c=a(11),l=n(c),f=/(\d{3})(?=\d)/g},function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=a(6),r=n(i),s=a(192),o=n(s),u=a(13),d=n(u),c=a(90),l=a(168),f=n(l),m=a(170),p=n(m),h=a(172),v=n(h),_=a(173),y=n(_),g=a(169),b=n(g),C=a(174),k=n(C),x=a(171),w=n(x);r.default.use(o.default);var I=new o.default({mode:"history",scrollBehavior:function(){return{y:0}},routes:[{name:"home",path:"/home",component:f.default},{path:"/login",component:p.default},{path:"/register",component:v.default},{name:"top",path:"/top",component:(0,c.createList)("top")},{name:"new",path:"/new",component:(0,c.createList)("new")},{name:"query",path:"/query",component:w.default},{name:"item",path:"/item/:id",component:b.default},{name:"user",path:"/user/:uid",component:y.default,children:[{path:"books",name:"userbooks",component:k.default}]},{path:"/logout",beforeEnter:function(t,e,a){d.default.dispatch("logout").then(function(t){a("/home")})}},{path:"*",redirect:"/home"}]});e.default=I},function(t,e,a){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e.default=t,e}function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(t.length){var a=t.indexOf(e);if(a>-1)return t.splice(a,1)}}function s(t,e,a){var n=null;return n=t?e.users[a]:e.items[a]}Object.defineProperty(e,"__esModule",{value:!0});var o,u=a(29),d=i(u),c=a(28),l=i(c),f=a(44),m=i(f),p=a(19),h=i(p),v=a(18),_=i(v),y=function(){var t=(0,_.default)(h.default.mark(function t(){return h.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",I.default.transaction("maxid",1));case 1:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),g=function(){var t=(0,_.default)(h.default.mark(function t(e,a){var n,i,r,o,u,d,c=e.commit,l=e.state;return h.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=""+a,i="item/",r=A.ADD_ITEM_TO_CACHE,o=null,u=!/^[0-9]*$/.test(n),u?(i="user/",r=A.ADD_USER_TO_CACHE,o=l.users[a]):o=l.items[a],o){t.next=33;break}d=0;case 8:if(!(E[n]&&d<10)){t.next=15;break}return d++,I.default.debug&&console.log("sleep ",d,n),t.next=13,N(100);case 13:t.next=8;break;case 15:if(0!=d&&10!=d){t.next=24;break}return E[n]=!0,t.next=19,I.default.fetch(i+n);case 19:o=t.sent,c(r,{record:o}),E[n]=!1,t.next=31;break;case 24:if(I.default.debug&&console.log("hit:",n),o=s(u,l,a)){t.next=31;break}return t.next=29,I.default.fetch(i+n);case 29:o=t.sent,c(r,{record:o});case 31:t.next=34;break;case 33:I.default.debug&&console.log("hit:",n);case 34:return t.abrupt("return",o);case 35:case"end":return t.stop()}},t,this)}));return function(e,a){return t.apply(this,arguments)}}(),b=a(6),C=i(b),k=a(11),x=i(k),w=a(12),I=i(w),R=a(17),M=a(27),A=n(M),O=[],E={},L={items:{},users:{}},N=function(t){return new m.default(function(e,a){setTimeout(function(){e(!0)},t)})},U={query:function(){function t(t,a){return e.apply(this,arguments)}var e=(0,_.default)(h.default.mark(function t(e,a){var n,i,r,s,o,u,d,c=e.dispatch,l=a.keys,f=a.ids;return h.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=l.split(" "),i=[],r=0;case 3:if(!(r<f.length)){t.next=21;break}return s=f[r],t.next=7,c("loadItem",s);case 7:o=t.sent,u=!0,d=0;case 10:if(!(d<n.length)){t.next=17;break}if(u=u&&String(o.keywords).indexOf(n[d])>-1){t.next=14;break}return t.abrupt("break",17);case 14:d++,t.next=10;break;case 17:u&&i.push(o);case 18:r++,t.next=3;break;case 21:return t.abrupt("return",i);case 22:case"end":return t.stop()}},t,this)}));return t}(),likeItem:function(){var t=(0,_.default)(h.default.mark(function t(e,a){var n,i,r,s,o=e.commit,u=e.dispatch,d=(e.state,a.uid),c=a.id;return h.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u("loadUser",d);case 2:return n=t.sent,t.next=5,u("loadItem",c);case 5:return i=t.sent,t.next=8,I.default.fetch("item/"+c+"/likes/"+d);case 8:if(r=t.sent){t.next=18;break}return t.next=12,I.default.save("item/"+c+"/likes/"+d,!0);case 12:return o(A.SYNC_LIKES,{id:c,uid:d}),t.next=15,I.default.fetch("top-books/"+c);case 15:return s=t.sent,t.next=18,I.default.save("top-books/"+c,Number(s)+1);case 18:case"end":return t.stop()}},t,void 0)}));return function(e,a){return t.apply(this,arguments)}}(),updateItem:function(){var t=(0,_.default)(h.default.mark(function t(e,a){var n,i=e.commit,r=e.dispatch,s=e.state;return h.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=a.id,t.next=3,I.default.update("item/"+n,a);case 3:if(!s.items[a.id]){t.next=7;break}return i(A.DEL_ITEM_FROM_CACHE,{item:a}),t.next=7,r("loadItem",a.id);case 7:case"end":return t.stop()}},t,void 0)}));return function(e,a){return t.apply(this,arguments)}}(),addItem:function(){var t=(0,_.default)(h.default.mark(function t(e,a){var n,i,r,s,o,u,d,c=e.commit,l=e.dispatch;return h.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return I.default.debug&&console.log("addItem--",a.title),t.next=3,y();case 3:return n=a.id=t.sent,i=a.uid?a.uid:I.default.curUser().uid,t.next=7,l("loadUser",i);case 7:return r=t.sent,a.uid=i,a.by=r.displayName,a.time=Date.now(),a.type&&""!==a.type.trim()||(a.type=a.parent>0?"comment":"book",I.default.debug&&console.log("type--",a.type)),s=a.parent,t.next=15,I.default.save("item/"+n,a);case 15:if(!(s>0)){t.next=21;break}return o="item/"+s,I.default.debug&&console.log("save--",o+("/kids/"+n)),t.next=20,I.default.save(o+("/kids/"+n),!0);case 20:c(A.SYNC_KIDS,{pid:s,id:n});case 21:if("book"!==a.type){t.next=25;break}return I.default.debug&&console.log("save--","new-books/"+n),t.next=25,I.default.save("new-books/"+n,!0);case 25:return u=a.type+("s/"+n),I.default.debug&&console.log("save--","user/"+i+"/"+u),t.next=29,I.default.save("user/"+i+"/"+u,!0);case 29:return c(A.SYNC_OWNED,{uid:i,key:u}),d="book"==a.type?"书":"评论",d="加入新"+d,I.default.debug&&console.log("save--feed"),t.next=35,I.default.push("feed/",{uid:i,id:n,event:d,time:Date.now()});case 35:return t.abrupt("return",a);case 36:case"end":return t.stop()}},t,void 0)}));return function(e,a){return t.apply(this,arguments)}}(),loadItems:function(){var t=(0,_.default)(h.default.mark(function t(e,a){var n=(e.commit,e.dispatch);return h.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!a||!a.length){t.next=4;break}return t.next=3,m.default.all(a.map(function(t){return n("loadItem",t)}));case 3:return t.abrupt("return",t.sent);case 4:return t.next=6,m.default.resolve([]);case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}},t,void 0)}));return function(e,a){return t.apply(this,arguments)}}(),loadItem:function(){var t=(0,_.default)(h.default.mark(function t(e,a){var n=e.commit,i=e.state;return h.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g({commit:n,state:i},a);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,void 0)}));return function(e,a){return t.apply(this,arguments)}}(),loadUser:function(){var t=(0,_.default)(h.default.mark(function t(e,a){var n=e.commit,i=e.state;return h.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g({commit:n,state:i},a);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,void 0)}));return function(e,a){return t.apply(this,arguments)}}(),loadItemsByUser:function(t,e){var a=this,n=t.dispatch,i=e.uid,r=e.type;return(0,_.default)(h.default.mark(function t(){var e,s,o;return h.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n("loadUser",i);case 2:if(e=t.sent){t.next=6;break}return console.log("loadUser fail for:",i),t.abrupt("return",[]);case 6:return s=e[r+"s"]||{},o=(0,R.ObjIntPropKeys2Array)(s),t.next=10,n("loadItems",o);case 10:return t.abrupt("return",t.sent);case 11:case"end":return t.stop()}},t,a)}))()},debug:function(t){var e=t.state,a=O.length;console.log("FIFI have "+a+" items");var n=(0,l.default)(e.users);console.log("cached users:"+n.length),n.forEach(function(t){console.log("user :",e.users[t].displayName)});var i=(0,l.default)(e.items);console.log("cached items:"+i.length),i.forEach(function(t){console.log("item :",e.items[t].title)})}},F=(o={},(0,d.default)(o,A.SYNC_KIDS,function(t,e){var a=e.pid,n=e.id,i=t.items[a],r=""+n;i&&(i.kids||C.default.set(i,"kids",{}),C.default.set(i.kids,r,!0))}),(0,d.default)(o,A.SYNC_OWNED,function(t,e){var a=e.uid,n=e.key,i=t.users[a];if(i){var r=n.split("/");i[r[0]]||C.default.set(i,r[0],{}),C.default.set(i[r[0]],r[1],!0)}}),(0,d.default)(o,A.SYNC_LIKES,function(t,e){var a=e.uid,n=e.id,i=t.items[n],r=""+a;i&&(i.likes||C.default.set(i,"likes",{}),C.default.set(i.likes,r,!0))}),(0,d.default)(o,A.DEL_ITEM_FROM_CACHE,function(t,e){var a=e.item;r(O,a),C.default.delete(t.items,a.id)}),(0,d.default)(o,A.DEL_USER_FROM_CACHE,function(t,e){var a=e.user;r(O,a),C.default.delete(t.users,a.uid)}),(0,d.default)(o,A.ADD_ITEM_TO_CACHE,function(t,e){var a=e.record;if(a&&(I.default.debug&&console.log("ADD_ITEM_TO_CACHE",a.title),C.default.set(t.items,a.id,a),O.push(a),O.length>x.default.CACHE.MAX_RECORDS)){var n=O.shift();n.id?(I.default.debug&&console.log("RM_ITEM_FROM_CACHE",n.title),C.default.delete(t.items,n.id)):(I.default.debug&&console.log("RM_USER_FROM_CACHE",n.displayName),C.default.delete(t.users,n.uid))}}),(0,d.default)(o,A.ADD_USER_TO_CACHE,function(t,e){var a=e.record;if(a&&(I.default.debug&&console.log("ADD_USER_TO_CACHE",a.displayName),C.default.set(t.users,a.uid,a),O.push(a),O.length>x.default.CACHE.MAX_RECORDS)){var n=O.shift();n.id?(I.default.debug&&console.log("RM_ITEM_FROM_CACHE",n.title),C.default.delete(t.items,n.id)):(I.default.debug&&console.log("RM_USER_FROM_CACHE",n.displayName),C.default.delete(t.users,n.uid))}}),o);e.default={state:L,actions:U,mutations:F}},function(t,e,a){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e.default=t,e}function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r,s=a(29),o=i(s),u=a(27),d=n(u),c={loading:!1,type:"info",notify:"亲!您现在是访客身份，注册后才能借书喔:-)"},l={loading:function(t){return t.loading},notifyType:function(t){return t.type},notifyMsg:function(t){return t.notify}},f={beginLoad:function(t){var e=t.commit;e(d.MSG_LOADING)},afterLoad:function(t){var e=t.commit;e(d.MSG_LOADED)},notify:function(t,e){var a=t.commit;a(d.MSG_NOTIFY,e)}},m=(r={},(0,o.default)(r,d.MSG_LOADING,function(t){t.loading=!0,t.type="info",t.notify="加载中..."}),(0,o.default)(r,d.MSG_LOADED,function(t){t.loading=!1,t.type="info",t.notify=""}),(0,o.default)(r,d.MSG_NOTIFY,function(t,e){var a=e.type,n=e.notify;t.type=a,t.notify=n}),r);e.default={state:c,getters:l,actions:f,mutations:m}},function(t,e,a){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e.default=t,e}
function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r,s=a(29),o=i(s),u=a(19),d=i(u),c=a(18),l=i(c),f=a(27),m=n(f),p=a(6),h=(i(p),a(12)),v=i(h),_={authenticated:!1,uid:null,email:"",displayName:""},y={authenticated:function(t){return t.authenticated},myId:function(t){return t.uid},myName:function(t){return t.displayName},myEmail:function(t){return t.email}},g={register:function(t,e){var a=(t.commit,e.mobile),n=e.pass;return v.default.createUser(a,n)},login:function(t,e){var a=this,n=t.commit,i=t.dispatch,r=e.mobile,s=e.pass;return(0,l.default)(d.default.mark(function t(){var e,o,u;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i("beginLoad");case 2:return e=null,t.prev=3,t.next=6,v.default.login(r,s);case 6:return e=t.sent,t.next=9,i("afterLoad");case 9:return n(m.AUTH_LOGGEDIN,{user:e}),o="欢迎你－－"+e.displayName,t.next=13,i("notify",{type:"info",notify:o});case 13:return t.abrupt("return",e);case 16:return t.prev=16,t.t0=t.catch(3),console.log(t.t0),t.next=21,i("afterLoad");case 21:return u="登录失败，请检查手机号或密码是否正确！",t.next=24,i("notify",{type:"error",notify:u});case 24:return t.abrupt("return",null);case 25:case"end":return t.stop()}},t,a,[[3,16]])}))()},logout:function(t){var e=t.commit,a=t.dispatch,n=t.getters;a("beginLoad");var i=n.myName;v.default.logout().then(function(){a("afterLoad"),e(m.AUTH_LOGOUT),a("notify",{type:"info",notify:"再见，亲--"+i})}).catch(function(t){console.log(t),a("afterLoad"),e(m.AUTH_LOGOUT)})},updateProfile:function(t,e){var a=this,n=t.commit,i=t.dispatch,r=t.getters,s=e.user;return(0,l.default)(d.default.mark(function t(){return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i("beginLoad");case 2:if(t.prev=2,s.email==r.myEmail){t.next=6;break}return t.next=6,v.default.updateEmail(s.email);case 6:return t.next=8,v.default.updateProfile(s.displayName,s.photoURL);case 8:n(m.CHANGE_PROFILE,{user:s}),i("afterLoad"),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(2),console.log(t.t0),i("afterLoad");case 16:case"end":return t.stop()}},t,a,[[2,12]])}))()}},b=(r={},(0,o.default)(r,m.CHANGE_PROFILE,function(t,e){var a=e.user;t.info=a||{}}),(0,o.default)(r,m.AUTH_LOGGEDIN,function(t,e){var a=e.user;t.authenticated=!0;var n=a.uid,i=a.email,r=a.displayName;t.uid=n,t.displayName=r,t.email=i}),(0,o.default)(r,m.AUTH_LOGOUT,function(t){t.authenticated=!1,t.uid=null,t.displayName=""}),r);e.default={state:_,getters:y,actions:g,mutations:b}},function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t){return{name:t+"-books",render:function(e){return e(s.default,{props:{type:t}})}}}Object.defineProperty(e,"__esModule",{value:!0}),e.createList=i;var r=a(162),s=n(r)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e){},function(t,e){},,,,,,,,,,,,function(t,e,a){var n,i;n=a(66);var r=a(183);i=n=n||{},"object"!=typeof n.default&&"function"!=typeof n.default||(i=n=n.default),"function"==typeof i&&(i=i.options),i.render=r.render,i.staticRenderFns=r.staticRenderFns,t.exports=n},function(t,e,a){var n,i;n=a(67);var r=a(175);i=n=n||{},"object"!=typeof n.default&&"function"!=typeof n.default||(i=n=n.default),"function"==typeof i&&(i=i.options),i.render=r.render,i.staticRenderFns=r.staticRenderFns,t.exports=n},function(t,e,a){var n,i;n=a(69);var r=a(178);i=n=n||{},"object"!=typeof n.default&&"function"!=typeof n.default||(i=n=n.default),"function"==typeof i&&(i=i.options),i.render=r.render,i.staticRenderFns=r.staticRenderFns,t.exports=n},function(t,e,a){var n,i;n=a(70);var r=a(185);i=n=n||{},"object"!=typeof n.default&&"function"!=typeof n.default||(i=n=n.default),"function"==typeof i&&(i=i.options),i.render=r.render,i.staticRenderFns=r.staticRenderFns,t.exports=n},function(t,e,a){var n,i;n=a(71);var r=a(180);i=n=n||{},"object"!=typeof n.default&&"function"!=typeof n.default||(i=n=n.default),"function"==typeof i&&(i=i.options),i.render=r.render,i.staticRenderFns=r.staticRenderFns,t.exports=n},function(t,e,a){var n,i;a(147),n=a(73);var r=a(177);i=n=n||{},"object"!=typeof n.default&&"function"!=typeof n.default||(i=n=n.default),"function"==typeof i&&(i=i.options),i.render=r.render,i.staticRenderFns=r.staticRenderFns,t.exports=n},function(t,e,a){var n,i;n=a(74);var r=a(189);i=n=n||{},"object"!=typeof n.default&&"function"!=typeof n.default||(i=n=n.default),"function"==typeof i&&(i=i.options),i.render=r.render,i.staticRenderFns=r.staticRenderFns,t.exports=n},function(t,e,a){var n,i;n=a(75);var r=a(184);i=n=n||{},"object"!=typeof n.default&&"function"!=typeof n.default||(i=n=n.default),"function"==typeof i&&(i=i.options),i.render=r.render,i.staticRenderFns=r.staticRenderFns,t.exports=n},function(t,e,a){var n,i;a(148),n=a(76);var r=a(179);i=n=n||{},"object"!=typeof n.default&&"function"!=typeof n.default||(i=n=n.default),"function"==typeof i&&(i=i.options),i.render=r.render,i.staticRenderFns=r.staticRenderFns,t.exports=n},function(t,e,a){var n,i;n=a(77);var r=a(176);i=n=n||{},"object"!=typeof n.default&&"function"!=typeof n.default||(i=n=n.default),"function"==typeof i&&(i=i.options),i.render=r.render,i.staticRenderFns=r.staticRenderFns,t.exports=n},function(t,e,a){var n,i;n=a(78);var r=a(187);i=n=n||{},"object"!=typeof n.default&&"function"!=typeof n.default||(i=n=n.default),"function"==typeof i&&(i=i.options),i.render=r.render,i.staticRenderFns=r.staticRenderFns,t.exports=n},function(t,e,a){var n,i;n=a(79);var r=a(188);i=n=n||{},"object"!=typeof n.default&&"function"!=typeof n.default||(i=n=n.default),"function"==typeof i&&(i=i.options),i.render=r.render,i.staticRenderFns=r.staticRenderFns,t.exports=n},function(t,e,a){var n,i;n=a(80);var r=a(186);i=n=n||{},"object"!=typeof n.default&&"function"!=typeof n.default||(i=n=n.default),"function"==typeof i&&(i=i.options),i.render=r.render,i.staticRenderFns=r.staticRenderFns,t.exports=n},function(t,e,a){var n,i;n=a(81);var r=a(181);i=n=n||{},"object"!=typeof n.default&&"function"!=typeof n.default||(i=n=n.default),"function"==typeof i&&(i=i.options),i.render=r.render,i.staticRenderFns=r.staticRenderFns,t.exports=n},function(t,e,a){var n,i;n=a(82);var r=a(182);i=n=n||{},"object"!=typeof n.default&&"function"!=typeof n.default||(i=n=n.default),"function"==typeof i&&(i=i.options),i.render=r.render,i.staticRenderFns=r.staticRenderFns,t.exports=n},function(t,e){t.exports={render:function(){var t=this;return t._h("div",{staticClass:"ui  secondary pointing menu",attrs:{"data-garbage":"true"}},[t._h("router-link",{class:t.myclass("/home"),attrs:{to:"/home"}},["首页"])," ",t._h("router-link",{class:t.myclass("/new"),attrs:{to:"/new"}},["最新"])," ",t._h("router-link",{class:t.myclass("/top"),attrs:{to:"/top"}},["最热"])," ",t._h("div",{staticClass:"right menu",attrs:{"data-garbage":"true"}},[t.authenticated?t._h("router-link",{staticClass:"ui  button",attrs:{to:"/logout"}},["注销"]):t._e()," ",t.authenticated?t._e():t._h("router-link",{staticClass:"ui small primary  button",attrs:{to:"/login"}},["登录"])])])},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this;return t._h("div",{attrs:{id:"iteminfo"}},[t._h("div",{staticClass:"ui top attached tabular menu",attrs:{"data-garbage":"true"}},[t._h("a",{staticClass:"item active",attrs:{"data-tab":"data"}},[t._s(0==t.item.parent?"图书信息":"评论信息")])," ",t._h("a",{staticClass:"item",attrs:{"data-tab":"images"}},["图片浏览"])])," ",t._h("div",{staticClass:"ui bottom attached tab segment active",attrs:{"data-tab":"data"}},[t._h("div",{directives:[{name:"show",rawName:"v-show",value:t.itsMe(t.item.uid),expression:"itsMe(item.uid)"}]},[t._h("div",{staticClass:"ui button",attrs:{id:"editbook"}},["修改图书"])," ",t._h("item-edit",{attrs:{itemId:Number(t.$route.params.id),type:"book"}})])," ",t._h("div",[t._h("h2",[t._s(t.item.title)])," ",t._h("p",{staticClass:"meta"},["\n\t\t\t\t"+t._s(t.item.by)+" 发表于 "+t._s(t._f("timeAgo")(t.item.time))+"\n\t\t\t"])," ",t._h("div",{staticClass:"extra content",domProps:{innerHTML:t._s(t.item.text)}})])," ",t._h("p",{staticClass:"ui dividing header"},["\n\t\t\t"+t._s(t.keys.length>0?t.keys.length+"条回复":"目前还未有回复.")+"\n\t\t"])," ",t.keys?t._h("div",{staticClass:"ui threaded comments",attrs:{"data-garbage":"true"}},[t._l(t.keys,function(e){return t._h("comment",{key:e,attrs:{id:e,curItemId:t.curItemId},on:{ReplyFor:t.updateReplyId}})})]):t._e()," ",t.authenticated?t._h("form",{staticClass:"ui reply form"},[t._h("div",{staticClass:"field"},[t._h("input",{directives:[{name:"model",rawName:"v-model",value:t.newTitle,expression:"newTitle"}],attrs:{type:"text",placeholder:"摘要..."},domProps:{value:t._s(t.newTitle)},on:{input:function(e){e.target.composing||(t.newTitle=e.target.value)}}})])," ",t._h("div",{staticClass:"field"},[t._h("textarea",{directives:[{name:"model",rawName:"v-model",value:t.newText,expression:"newText"}],domProps:{value:t._s(t.newText)},on:{input:function(e){e.target.composing||(t.newText=e.target.value)}}})])," ",t._h("div",{staticClass:"ui blue labeled  icon button"},[t._h("i",{staticClass:"icon edit"})," ",t._h("div",{on:{click:t.addComment}},[" 回复"])])]):t._e()])," ",t._h("div",{staticClass:"ui bottom attached tab segment",attrs:{"data-tab":"images","data-garbage":"true"}},[t._h("div",{staticClass:"ui  divider"})," ",t._l(t.images,function(e,a){return t._h("div",{attrs:{id:"img-"+a}},[t._h("img",{staticClass:"ui medium image",attrs:{src:t._f("tansformImageURL")(e)}})," ",t._h("div",{staticClass:"ui  divider"})])})])])},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this;return t.filteredData.length?t._h("table",[t._h("thead",[t._h("tr",[t._l(t.columns,function(e){return t._h("th",{class:{active:t.sortKey==e.key},on:{click:function(a){t.sortBy(e.key)}}},["\n             "+t._s(e.text)+"\n             ",t._h("span",{staticClass:"arrow",class:t.sortOrders[e.key]>0?"asc":"dsc"})])})," ",t._h("th",["操作"])])])," ",t._h("tbody",[t._l(t.filteredData,function(e){return t._h("tr",[t._l(t.columns,function(a){return t._h("td",["\n             "+t._s(e[a.key])+"\n           "])})," ",t._h("td",[t._h("div",{staticClass:"ui button",on:{click:function(a){t.callback(e.id)}}},["\n             详细资料\n             "])])])})])]):t._h("p",["没有匹配的数据结果。"])},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this;return t._h("div",{staticClass:"ui segment",attrs:{"data-garbage":"true"}},[t._h("div",{staticClass:"ui three doubling cards"},[t._l(t.books,function(e){return t._h("book-card",{key:e.id,attrs:{item:e}})})])])},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this;return t._h("div",[t._h("div",{staticClass:"ui vertical masthead  segment"},[t._h("div",{staticClass:"ui very large feed"},[t._l(t.feeds,function(e){return t._h("feed",{attrs:{record:e}})})])])," ",t._h("div",{staticClass:"ui vertical masthead center aligned  segment"},[t._h("div",{staticClass:"ui text container"},[t._m(0)," ",t._m(1)," ",t._h("div",{staticClass:"ui huge primary button",on:{click:function(e){t.login()}}},["Get Started ",t._h("i",{staticClass:"right arrow icon"})])])])," ",t._m(2)])},staticRenderFns:[function(){var t=this;return t._h("h3",{staticClass:"ui header"},["\n                图书交流小助手",t._h("br"),"Books Share\n            "])},function(){var t=this;return t._h("div",{staticClass:"ui steps tablet stackable"},[t._h("div",{staticClass:"step active"},[t._h("i",{staticClass:"truck icon"})," ",t._h("div",{staticClass:"content"},[t._h("div",{staticClass:"title"},["浏览"])," ",t._h("div",{staticClass:"description"},["查找图书"])])])," ",t._h("div",{staticClass:"step"},[t._h("i",{staticClass:"alarm icon"})," ",t._h("div",{staticClass:"content"},[t._h("div",{staticClass:"title"},["注册"])," ",t._h("div",{staticClass:"description"},["注册借书"])])])," ",t._h("div",{staticClass:"step"},[t._h("i",{staticClass:"dashboard icon"})," ",t._h("div",{staticClass:"content"},[t._h("div",{staticClass:"title"},["贡献"])," ",t._h("div",{staticClass:"description"},["登记图书"])])])," ",t._h("div",{staticClass:"step"},[t._h("i",{staticClass:"comments icon"})," ",t._h("div",{staticClass:"content"},[t._h("div",{staticClass:"title"},["分享"])," ",t._h("div",{staticClass:"description"},["共同进步"])])])])},function(){var t=this;return t._h("div",{staticClass:"ui inverted vertical footer center aligned segment"},[t._h("div",{staticClass:"ui container"},[t._h("div",{staticClass:"ui stackable inverted divided equal height stackable grid"},[t._h("div",{staticClass:"six wide column"},[t._h("h3",{staticClass:"ui inverted header"},["感谢"])," ",t._h("div",{staticClass:"ui inverted link list"},[t._h("a",{staticClass:"item",attrs:{href:"http://vuejs.org/",target:"_blank"}},["Vue.js"])," ",t._h("a",{staticClass:"item",attrs:{href:"http://www.wilddog.com",target:"_blank"}},["Wilddog"])])])," ",t._h("div",{staticClass:"six wide column"},[t._h("h3",{staticClass:"ui inverted header"},["联系我们"])," ",t._h("div",{staticClass:"ui inverted link list"},[t._h("a",{staticClass:"item",attrs:{href:"http://github.com/share-book",target:"_blank"}},["Judy(13710711847@163.com)"])," ",t._h("a",{staticClass:"item",attrs:{href:"http://github.com/lshengjian",target:"_blank"}},["Alex(lsj178@139.com)"])])])])])])}]}},function(t,e){t.exports={render:function(){var t=this;return t._h("div",{staticClass:"event"},[t._h("div",{staticClass:"label"},[t._h("img",{attrs:{src:t._f("tansformAvatarURL")(t.user.photoURL||"")}})])," ",t._h("div",{staticClass:"content"},[t._h("div",{staticClass:"summary"},[t._h("router-link",{attrs:{to:{name:"user",params:{uid:t.record.uid}}}},["\n        "+t._s(t.item.by)+"\n      "]),"\n      "+t._s(t.record.event)+"\n\n      ",t._h("router-link",{attrs:{to:{name:"item",params:{id:t.record.id}}}},["\n        "+t._s(t.item.title)+"\n      "])," ",t._h("div",{staticClass:"date"},["\n        "+t._s(t._f("timeAgo")(t.item.time))+"\n      "])])," "])])},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this;return t._h("div",[t._h("div",{staticClass:"ui accordion"},[t._m(0)," ",t._h("div",{staticClass:"active content"},[t._h("user-edit")])])," ",t._h("router-view")])},staticRenderFns:[function(){var t=this;return t._h("div",{staticClass:"active title"},[t._h("i",{staticClass:"dropdown icon"}),"\n         个人资料\n       "])}]}},function(t,e){t.exports={render:function(){var t=this;return t._h("div",{staticClass:"userbooks"},[t.itsMe(t.$route.params.uid)?t._h("div",[t._h("div",{staticClass:"ui button",attrs:{id:"addbook"}},["新增图书"])," ",t._h("item-edit",{attrs:{itemId:0,type:"book"}})]):t._e()," ",t._h("div",{staticClass:"ui divider"})," ",t._h("p",{staticClass:"ui text"},["\n\t\tSearch ",t._h("input",{directives:[{name:"model",rawName:"v-model",value:t.searchQuery,expression:"searchQuery"}],attrs:{name:"query"},domProps:{value:t._s(t.searchQuery)},on:{input:function(e){e.target.composing||(t.searchQuery=e.target.value)}}})])," ",t._h("my-grid",{attrs:{data:t.books,columns:t.gridColumns,"filter-key":t.searchQuery,callback:t.showBook}})])},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this;return t._h("div",{staticClass:"ui container"},[t._h("app-menu")," ",t._h("div",{staticClass:"ui raised segments"},[t._h("div",{staticClass:"ui segment"},[t._h("notify")])," ",t._h("div",{staticClass:"ui",class:t.authenticated?"green segment":"error"==t.notifyType?"red segment":"yellow segment"},[t._h("router-view")])])])},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this;return t._h("div",{staticClass:"ui form",attrs:{id:"useredit"}},[t._h("div",{staticClass:"two fields"},[t._h("div",{staticClass:"field"},[t._h("label",["昵称"])," ",t._h("input",{directives:[{name:"model",rawName:"v-model",value:t.displayName,expression:"displayName"}],attrs:{type:"text",placeholder:"Name"},domProps:{value:t._s(t.displayName)},on:{input:function(e){e.target.composing||(t.displayName=e.target.value)}}})])," ",t._h("div",{staticClass:"field"},[t._h("label",["电子邮件"])," ",t._h("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],attrs:{type:"text",placeholder:"email"},domProps:{value:t._s(t.email)},on:{input:function(e){e.target.composing||(t.email=e.target.value)}}})])])," ",t._h("div",{staticClass:"three fields"},[t._h("img",{staticClass:"ui avatar image",attrs:{src:t._f("tansformAvatarURL")(t.photoURL)}})," ",t._h("div",{staticClass:"field"},[t._h("select",{directives:[{name:"model",rawName:"v-model",value:t.photoURL,expression:"photoURL"}],staticClass:"ui dropdown",attrs:{name:"photoIdx",id:"avatar"},on:{change:function(e){t.photoURL=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e})[0]}}},[t._l(t.map,function(e){return t._h("option",{domProps:{value:e.id}},[t._s(e.text)])})])])," ",t._h("div",{staticClass:"field"},[t._h("input",{directives:[{name:"model",rawName:"v-model",value:t.photoURL,expression:"photoURL"}],attrs:{type:"text",placeholder:"也可以是外部图片，如：http://www.pupha.net/wp-content/uploads/2014/03/Octocat.png"},domProps:{value:t._s(t.photoURL)},on:{input:function(e){e.target.composing||(t.photoURL=e.target.value)}}})])," ",t.itsMe(t.$route.params.uid)?t._h("div",{staticClass:"ui button",on:{click:function(e){t.save()}}},["保存"]):t._e()," ",t._h("router-link",{staticClass:"ui primary button",attrs:{to:t.booksURL}},["查看图书"])])," ",t._m(0)])},staticRenderFns:[function(){var t=this;return t._h("div",{staticClass:"ui dimmer"},[t._h("div",{staticClass:"content"},[t._h("div",{staticClass:"center"},[t._h("h2",{staticClass:"ui inverted icon  header"},[t._h("i",{staticClass:"heart icon"})," 成功更新资料!\n        "])])])])}]}},function(t,e){t.exports={render:function(){var t=this;return t._h("div",{staticClass:"comment",attrs:{"data-garbage":"true"}},[t._h("a",{staticClass:"avatar"},[t._h("img",{attrs:{src:t._f("tansformAvatarURL")(this.user.photoURL)}})])," ",t._h("div",{staticClass:"content"},[t._h("div",{staticClass:"metadata",attrs:{"data-garbage":"true"}},["\n        "+t._s(t.comment.by)+"\n        ",t._h("span",{staticClass:"date"},[" "+t._s(t._f("timeAgo")(t.comment.time))+" "])])," ",t.keys.length?t._h("span",["\n        | ",t._h("a",{staticClass:"expand",on:{click:function(e){t.open=!t.open}}},["\n          "+t._s((t.open?"收缩 ":"展开 ")+"--"+t.keys.length+"条回复")+"\n        "])]):t._e()," ",t._h("div",{staticClass:"text",domProps:{innerHTML:t._s(t.comment.title)}})," ",t._h("div",{staticClass:"extra content",domProps:{innerHTML:t._s(t.comment.text)}})," ",t._h("div",{staticClass:"actions",attrs:{"data-garbage":"true"}},[t._h("i",{directives:[{name:"show",rawName:"v-show",value:t.curItemId==t.id,expression:"curItemId==id"}],staticClass:"icon edit"})," ",t._h("a",{staticClass:"reply",on:{click:function(e){t.emitReplyFor(t.comment.id)}}},["回复"])])," ",t._h("div",{directives:[{name:"show",rawName:"v-show",value:t.open,expression:"open"}]},[t.keys&&t.keys.length?t._h("div",{staticClass:"ui threaded comments",attrs:{"data-garbage":"true"}},[t._l(t.keys,function(e){return t._h("comment",{key:e,attrs:{id:e,curItemId:t.curItemId},on:{ReplyFor:t.emitReplyFor}})})]):t._e()])])])},staticRenderFns:[]}},function(t,e,a){t.exports={render:function(){var t=this;return t._h("div",{staticClass:"ui middle aligned center aligned grid"},[t._h("div",{staticClass:"column"},[t._m(0)," ",t._h("form",{staticClass:"ui large form"},[t._h("div",{staticClass:"ui  segment"},[t._h("div",{staticClass:"field"},[t._h("div",{staticClass:"ui left icon input"},[t._h("i",{staticClass:"user icon"})," ",t._h("input",{directives:[{name:"model",rawName:"v-model",value:t.mobile,expression:"mobile"}],attrs:{type:"text",name:"mobile",placeholder:"Phone number"},domProps:{value:t._s(t.mobile)},on:{input:function(e){e.target.composing||(t.mobile=e.target.value)}}})])])," ",t._h("div",{staticClass:"field"},[t._h("div",{staticClass:"ui left icon input"},[t._h("i",{staticClass:"lock icon"})," ",t._h("input",{directives:[{name:"model",rawName:"v-model",value:t.pass,expression:"pass"}],attrs:{type:"password",name:"password",placeholder:"Password"},domProps:{value:t._s(t.pass)},on:{input:function(e){e.target.composing||(t.pass=e.target.value)}}})])])," ",t._h("div",{staticClass:"ui  large  button",on:{click:function(e){t.check()}}},["保存"])])," ",t._h("div",{staticClass:"ui error message"})])])])},staticRenderFns:[function(){var t=this;return t._h("h2",{staticClass:"ui teal image header"},[t._h("img",{staticClass:"image",attrs:{src:a(59)}})," ",t._h("div",{staticClass:"content"},["\n        注册新用户\n      "])])}]}},function(t,e,a){t.exports={render:function(){var t=this;return t._h("div",{staticClass:"ui middle aligned center aligned grid"},[t._h("div",{staticClass:"column"},[t._m(0)," ",t.$route.query.redirect?t._h("p",["\n      你要访问的内容有保护，请先登录系统！\n    "]):t._e()," ",t._h("form",{staticClass:"ui large form"},[t._h("div",{staticClass:"ui  segment"},[t._h("div",{staticClass:"field"},[t._h("div",{staticClass:"ui left icon input"},[t._h("i",{staticClass:"user icon"})," ",t._h("input",{directives:[{name:"model",rawName:"v-model",value:t.mobile,expression:"mobile"}],attrs:{type:"text",name:"mobile",placeholder:"Phone number"},domProps:{value:t._s(t.mobile)},on:{input:function(e){e.target.composing||(t.mobile=e.target.value)}}})])])," ",t._h("div",{staticClass:"field"},[t._h("div",{staticClass:"ui left icon input"},[t._h("i",{staticClass:"lock icon"})," ",t._h("input",{directives:[{name:"model",rawName:"v-model",value:t.pass,expression:"pass"}],attrs:{type:"password",name:"password",placeholder:"Password"},domProps:{value:t._s(t.pass)},on:{input:function(e){e.target.composing||(t.pass=e.target.value)}}})])])," ",t._h("div",{staticClass:"ui  large  button",on:{click:function(e){t.mylogin()}}},["登录"])," ",t._h("router-link",{staticClass:"ui large button",attrs:{to:"/register"}},["注册"])])," ",t._h("div",{staticClass:"ui error message"})," ",t._h("div")])])])},staticRenderFns:[function(){var t=this;return t._h("h2",{staticClass:"ui teal image header"},[t._h("img",{staticClass:"image",attrs:{src:a(59)}})," ",t._h("div",{staticClass:"content"},["\n        登录系统\n      "])])}]}},function(t,e){t.exports={render:function(){var t=this;return t._h("div",{staticClass:"ui segment",attrs:{"data-garbage":"true"}},[t._h("div",{staticClass:"ui three doubling cards"},[t._l(t.books,function(e){return t._h("book-card",{key:e.id,attrs:{item:e}})})])])},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this;return t._h("div",{staticClass:"ui secondary  menu",attrs:{"data-garbage":"true"}},[t._h("div",{staticClass:"item"},[t._h("div",{staticClass:"ui inline",class:t.loading?"loader active ":""}),"\n       "+t._s(t.notify)+"\n    "])," ",t._h("div",{staticClass:"right menu",attrs:{"data-garbage":"true"}},[t._h("div",{staticClass:"item"},[t._h("div",{staticClass:"ui icon input"},[t._h("input",{directives:[{name:"model",rawName:"v-model",value:t.txtQuery,expression:"txtQuery"}],attrs:{type:"text",placeholder:"查找..."},domProps:{value:t._s(t.txtQuery)},on:{keyup:function(e){13===e.keyCode&&t.search()},input:function(e){e.target.composing||(t.txtQuery=e.target.value)}}})," ",t._h("i",{staticClass:"search link icon",on:{click:function(e){t.search()}}})])])])])},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this;return t._h("div",{staticClass:"ui myitem modal",attrs:{"data-garbage":"true"}},[t._h("div",{staticClass:"header",attrs:{"data-garbage":"true"}},[t._s(t.header)])," ",t._h("div",{staticClass:"content"},[t._h("div",{staticClass:"ui form"},[t._h("div",{staticClass:"field"},[t._h("label",["标题"])," ",t._h("input",{directives:[{name:"model",rawName:"v-model",value:t.title,expression:"title"}],attrs:{type:"text",placeholder:"少于30个汉字"},domProps:{value:t._s(t.title)},on:{input:function(e){e.target.composing||(t.title=e.target.value)}}})])," ","book"==t.type?t._h("div",{staticClass:"field"},[t._h("label",["搜索关键字"])," ",t._h("input",{directives:[{name:"model",rawName:"v-model",value:t.keywords,expression:"keywords"}],attrs:{type:"text",placeholder:"5～8个关键字，空格或逗号分开"},domProps:{value:t._s(t.keywords)},on:{input:function(e){e.target.composing||(t.keywords=e.target.value)}}})]):t._e()," ","book"==t.type?t._h("div",{staticClass:"field"},[t._h("label",["图片地址"])," ",t._h("input",{directives:[{name:"model",rawName:"v-model",value:t.images,expression:"images"}],attrs:{type:"text",placeholder:"多个地址用空格分开"},domProps:{value:t._s(t.images)},on:{input:function(e){e.target.composing||(t.images=e.target.value)}}})]):t._e()," ",t._h("div",{staticClass:"field"},[t._h("label",["内容介绍"])," ",t._h("textarea",{directives:[{name:"model",rawName:"v-model",value:t.text,expression:"text"}],attrs:{placeholder:'特殊用法:换行--<br>　图片引用--<img src="http://服务器地址/名称.后缀">'},domProps:{value:t._s(t.text)},on:{input:function(e){e.target.composing||(t.text=e.target.value)}}})])])])," ",t._h("div",{staticClass:"actions"},[t._h("div",{staticClass:"ui  button",on:{click:t.save}},["保存"])," ",t._h("div",{staticClass:"ui cancel button"},["取消"])])])},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this;return t._h("div",{staticClass:"ui card",attrs:{id:t.item.id}},[t._m(0)," ",t._h("div",{staticClass:"content"},[t._h("div",{staticClass:"right floated meta",attrs:{"data-garbage":"true"}},[t._s(t._f("timeAgo")(t.item.time))])," ",t._h("img",{staticClass:"ui avatar image",attrs:{src:t._f("tansformAvatarURL")(this.user.photoURL)}})," ",t._h("router-link",{attrs:{to:"/user/"+t.item.uid}},[t._s(t.item.by)])])," ",t._h("img",{staticClass:"ui medium image",attrs:{src:t._f("tansformImageURL")(t.face)}})," ",t._h("div",{staticClass:"content"},[t._h("p",{staticClass:"header"},[t._s(t.item.title)])," ",t._h("span",{staticClass:"right floated"},[t.authenticated?t._h("i",{staticClass:"heart outline like icon",on:{click:t.iLike}}):t._e(),"\n       喜欢:"+t._s(t.likes.length)+" \n    "])," ",t._h("i",{staticClass:"comment icon",attrs:{"data-garbage":"true"}})," ",t._h("router-link",{attrs:{to:"/item/"+t.item.id}},["评论:"+t._s(t.kids.length)+" "])])," ",t.authenticated?t._h("div",{staticClass:"extra content"},[t._h("div",{staticClass:"ui large transparent  input"},[t._h("input",{directives:[{name:"model",rawName:"v-model",value:t.newComment,expression:"newComment"}],attrs:{type:"text",placeholder:"我要评价..."},domProps:{value:t._s(t.newComment)},on:{keyup:function(e){13===e.keyCode&&t.addComment()},input:function(e){e.target.composing||(t.newComment=e.target.value)}}})])]):t._e()])},staticRenderFns:[function(){var t=this;return t._h("div",{staticClass:"ui dimmer"},[t._h("div",{staticClass:"content"},[t._h("div",{staticClass:"center"},[t._h("h2",{staticClass:"ui inverted icon  header"},[t._h("i",{staticClass:"heart icon"})," 资料保存成功!\n\t\t\t\t\t"])])])])}]}},,,,,,,function(t,e){}]);
//# sourceMappingURL=app.ed7ac19fcc19f2b4df1d.js.map